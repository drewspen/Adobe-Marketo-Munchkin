___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Adobe Marketo Munchkin",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "marketoMunchkinId",
    "displayName": "marketoMunchkinId",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[0-9].*\\-.*\\-[0-9].*"
        ]
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "marketoMunchScriptUrl",
    "displayName": "marketoMunchScriptUrl",
    "simpleValueType": true,
    "defaultValue": "https://munchkin.marketo.net/munchkin.js",
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^https\\:\\/\\/.*marketo.*\\.js$"
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const injectScript = require('injectScript');
const createQueue = require('createQueue');
const callInWindow = require('callInWindow');
const setInWindow = require('setInWindow');
//const getUrl = require('getUrl');

// Get the Munchkin ID from template field
const munchkinId = data.marketoMunchkinId;
const scriptUrl = data.marketoMunchScriptUrl;

// Set up initialization function
const initMunchkin = () => {
  callInWindow('Munchkin.init', munchkinId);
  data.gtmOnSuccess();
};

// Set the init function in window for callback
setInWindow('_munchkinInit', initMunchkin);

injectScript(scriptUrl, () => {
  // Success callback - script loaded, now initialize
  callInWindow('_munchkinInit');
}, () => {
  // Error callback - script failed to load
  log('Failed to load Munchkin script');
  data.gtmOnFailure();
});


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Munchkin.init"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_munchkinInit"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://munchkin.marketo.net/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 6/9/2025, 8:49:34 AM


